\usepackage{xcolor, tcolorbox}
\tcbuselibrary{most}
\usepackage{amsthm, amsmath}
\usepackage{xparse}
\usepackage{etoolbox} 

% \usepackage{cmbright}
\usepackage{mathpazo}
\usepackage[T1]{fontenc}

% Define colors
\definecolor{defcolor}{RGB}{173,0,230} % light blue
\definecolor{propcolor}{HTML}{733B1F}
\definecolor{thmcolor}{HTML}{733B1F}
\definecolor{corcolor}{HTML}{733B1F} % pink
% \definecolor{lemcolor}{RGB}{173, 114, 40} % pink
\definecolor{lemcolor}{HTML}{733B1F}
\definecolor{lembordercolor}{HTML}{94330F}
\definecolor{notcolor}{RGB}{84, 0, 209}
\definecolor{remcolor}{RGB}{191, 25, 69}


\newcounter{ctr}[subsection]
\renewcommand{\thectr}{\thesubsection.\arabic{ctr}}

\renewcommand\textsc[1]{\uppercase{{\scriptsize #1}}}

\NewDocumentEnvironment{definition}{o} % No arguments
{
	\refstepcounter{ctr}
  \begin{tcolorbox}[
    enhanced,                      % Enable advanced features
    colback=defcolor!4,           % Background color at 50% opacity
    colframe=white,                % Frame color (set to white or as desired)
    boxrule=0pt,                   % No default frame border
    left=7pt,                      % No left padding
    right=4.5pt,                     % No right padding
    top=2pt,                       % Top padding
    bottom=2pt,                    % Bottom padding
    overlay={                      % Add custom graphics on top
      \fill[defcolor] (frame.south west) 
        rectangle ([xshift=2.5pt]frame.north west); % Left colored edge
    },
    sharp corners,                 % Sharp (non-rounded) corners
    breakable,                     % Allow box to break across pages
    before skip=10pt,              % Space before the box
    after skip=10pt,               % Space after the box
    boxsep=5pt                     % Separation between box and content
  ]
  \bfseries{\textcolor{defcolor}{Définition \thectr\IfValueT{#1}{ \normalfont(#1)}.}}\normalfont % Prefix with "Definition [number]"
}{
  \end{tcolorbox}
}

\NewDocumentEnvironment{cor}{o} % No arguments
{
	\refstepcounter{ctr}
  \begin{tcolorbox}[
    enhanced,                      % Enable advanced features
		skin=bicolor,
    colback=lembordercolor!8,           % Background color at 50% opacity
		colbacklower=lemcolor!2,
    colframe=white,                % Frame color (set to white or as desired)
    boxrule=0pt,                   % No default frame border
    left=7pt,                      % No left padding
    right=0pt,                     % No right padding
    top=2pt,                       % Top padding
    bottom=2pt,                    % Bottom padding
    overlay={                      % Add custom graphics on top
      \fill[lembordercolor] (frame.south west)
        rectangle ([xshift=2.5pt]frame.north west); % Left colored edge
    },
    sharp corners,                 % Sharp (non-rounded) corners
    breakable,                     % Allow box to break across pages
    before skip=10pt,              % Space before the box
    after skip=10pt,               % Space after the box
    boxsep=5pt                     % Separation between box and content
  ]
  \bfseries{\textcolor{lemcolor}{Corollaire \thectr\IfValueT{#1}{ \normalfont(#1)}.}}\normalfont % Prefix with "Definition [number]"
}{
  \end{tcolorbox}
}


\NewDocumentEnvironment{lemme}{o} % No arguments
{
	\refstepcounter{ctr}
  \begin{tcolorbox}[
    enhanced,                      % Enable advanced features
		skin=bicolor,
    colback=lembordercolor!8,           % Background color at 50% opacity
		colbacklower=lemcolor!2,
    colframe=white,                % Frame color (set to white or as desired)
    boxrule=0pt,                   % No default frame border
    left=7pt,                      % No left padding
    right=0pt,                     % No right padding
    top=2pt,                       % Top padding
    bottom=2pt,                    % Bottom padding
    overlay={                      % Add custom graphics on top
      \fill[lembordercolor] (frame.south west)
        rectangle ([xshift=2.5pt]frame.north west); % Left colored edge
    },
    sharp corners,                 % Sharp (non-rounded) corners
    breakable,                     % Allow box to break across pages
    before skip=10pt,              % Space before the box
    after skip=10pt,               % Space after the box
    boxsep=5pt                     % Separation between box and content
  ]
  \bfseries{\textcolor{lemcolor}{Lemme \thectr\IfValueT{#1}{ \normalfont(#1)}.}}\normalfont % Prefix with "Definition [number]"
}{
  \end{tcolorbox}
}

\NewDocumentEnvironment{propo}{o} % No arguments
{
	\refstepcounter{ctr}
  \begin{tcolorbox}[
    enhanced,                      % Enable advanced features
		skin=bicolor,
    colback=lembordercolor!8,           % Background color at 50% opacity
		colbacklower=lemcolor!2,
    colframe=white,                % Frame color (set to white or as desired)
    boxrule=0pt,                   % No default frame border
    left=7pt,                      % No left padding
    right=0pt,                     % No right padding
    top=2pt,                       % Top padding
    bottom=2pt,                    % Bottom padding
    overlay={                      % Add custom graphics on top
      \fill[lembordercolor] (frame.south west)
        rectangle ([xshift=2.5pt]frame.north west); % Left colored edge
    },
    sharp corners,                 % Sharp (non-rounded) corners
    breakable,                     % Allow box to break across pages
    before skip=10pt,              % Space before the box
    after skip=10pt,               % Space after the box
    boxsep=5pt                     % Separation between box and content
  ]
  \bfseries{\textcolor{lemcolor}{Proposition \thectr\IfValueT{#1}{ \normalfont(#1)}.}}\normalfont % Prefix with "Definition [number]"
}{
  \end{tcolorbox}
}


\NewDocumentEnvironment{theoreme}{o} % No arguments
{
	\refstepcounter{ctr}
  \begin{tcolorbox}[
    enhanced,                      % Enable advanced features
		skin=bicolor,
    colback=lembordercolor!8,           % Background color at 50% opacity
		colbacklower=lemcolor!2,
    colframe=white,                % Frame color (set to white or as desired)
    boxrule=0pt,                   % No default frame border
    left=7pt,                      % No left padding
    right=4.5pt,                     % No right padding
    top=2pt,                       % Top padding
    bottom=2pt,                    % Bottom padding
    overlay={                      % Add custom graphics on top
      \fill[lembordercolor] (frame.south west) 
        rectangle ([xshift=2.5pt]frame.north west); % Left colored edge
    },
    sharp corners,                 % Sharp (non-rounded) corners
    breakable,                     % Allow box to break across pages
    before skip=10pt,              % Space before the box
    after skip=10pt,               % Space after the box
    boxsep=5pt,                     % Separation between box and content
    % middle=3pt
  ]
  \bfseries{\textcolor{thmcolor}{Théorème \thectr\IfValueT{#1}{ \normalfont(#1)}.}}\normalfont % Prefix with "Definition [number]"
}{
  \end{tcolorbox}
}

\NewDocumentEnvironment{remarque}{o} % No arguments
{
  \begin{tcolorbox}[
    enhanced,                      % Enable advanced features
    colback=remcolor!0,           % Background color at 50% opacity
    colframe=white,                % Frame color (set to white or as desired)
    boxrule=0pt,                   % No default frame border
    left=7pt,                      % No left padding
    right=0pt,                     % No right padding
    top=2pt,                       % Top padding
    bottom=2pt,                    % Bottom padding
    overlay={                      % Add custom graphics on top
      \fill[remcolor] (frame.south west) 
        rectangle ([xshift=2.5pt]frame.north west); % Left colored edge
    },
    sharp corners,                 % Sharp (non-rounded) corners
    breakable,                     % Allow box to break across pages
    before skip=10pt,              % Space before the box
    after skip=10pt,               % Space after the box
    boxsep=5pt                     % Separation between box and content
  ]
  \bfseries{\textcolor{remcolor}{Remarque\IfValueT{#1}{ \normalfont(#1)}.}}\normalfont % Prefix with "Definition [number]"
}{
  \end{tcolorbox}
}



%\newenvironment{corollary}[1][]{%
%	\begin{trivlist}
%		\item[\hskip \labelsep {\textcolor{corcolor}{\textit{Corollary.}}}] #1
%	}{%
%	\end{trivlist}
%}

\NewDocumentEnvironment{notation}{ o }{%
	\refstepcounter{ctr}
	\begin{trivlist}
		\item[\hskip \labelsep {\textcolor{notcolor}{ \headingfont{ Notation ~\thectr{} \normalfont \IfNoValueTF{#1} {} {~(#1)} \headingfont.}}}]
	}{%
	\end{trivlist}
}

\NewDocumentEnvironment{exemple}{ o }{%
	\refstepcounter{ctr}
	\begin{trivlist}
		\item[\hskip \labelsep {{ \headingfont{ Exemple ~\thectr{} \normalfont \IfNoValueTF{#1} {} {~(#1)} \headingfont.}}}]
	}{%
	\end{trivlist}
}



%\newenvironment{notation}[1][]{%
%	\begin{trivlist}
%		\item[\hskip \labelsep {\textcolor{notcolor}{\textit{Notation.}}}] #1
%	}{%
%	\end{trivlist}
%}

\ExplSyntaxOff

% Optional proof environment
\newenvironment{preuve}{%
	\begin{trivlist}
		\item[\hskip \labelsep {{\textit{\bfseries\textsc{\scriptsize \headingfont Démonstration.}}}}]
	}{%
	\qed
	\end{trivlist}
}
